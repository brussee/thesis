Modern media and news distribution is shifting from traditional media to social media.
Modern media production and information distribution is shifting from traditional outlets.
Also media consumption is shifting from traditional outlets to digital and mobile devices.
from con-sumer to pro-sumer.
Niet gebonden aan expert opinion / editorial, maar aan eigen mening zonder professionele studio / news desk / kantoor; maar juist mobile eye-witness; direct van individu naar massa!

%What advantages does a smart phone have compared to a laptop and desktop?
Given this context mobile devices are increasingly important and smart-phone in particular.
A smart-phone has the unique property of being a ubiquitous device that is highly mobile and extremely connectible.
Most smart-phones even have one or more cameras to produce multi-media content that can be shared immediately from the device.
Finally the entire world has a smart-phone.
Even or especially areas without tradition infrastructure they are ubiquitous.

In crisis situations, like natural disaster or unrest, the smart-phone becomes particularly important, exactly for the earlier mentioned properties, as under such conditions utilizing centralized infrastructure is undesired (censorship) or physically impossible.
Decentralized can work in these situations.
Censorsihp and large scale monitoring is difficult in decentralized networks.
Refereren aan article Johan 2011 voorbeeld.


Tribler is a fully decentralized video-on-demand platform.
It is autonomous, attack-resilient and self-organizing.
It uses network overlays called communities to offer features like keyword search and managing contributions to channels for discover-ability of content.
It offers privacy through layered encrypted tunnels similar to the TOR network. |BREAK| using UDP rather than TCP.
This privacy feature requires a lot more bandwidth of the network than without anonymity: a ratio of 13 GB for every anonymous 1 GB of data.
Since bandwidth is limited and transitory it can be beneficial to exchange unused bandwidth for a promise of bandwidth in the future, or another reward.
The research group behind Tribler is currently building a fully decentralized accounting system and open exchange market using block-chain technology with the purpose of building trust on-line and creating the Internet of Money.
% not only benefit the users thanks to an increase of available bandwidth, but more importantly  MAYBE more users, more bandwidth necessary. % Credit mining on device A to be consumed on device B.
Expanding the Tribler network would improve the usefulness of experiments on the live network for this large scale system.

|BREAK|
So far Tribler only supports desktop and server versions of Linux, Mac and Windows.
The necessity of moving to mobile devices calls for Tribler functionality to be enabled to run on these resource limited devices.
In this thesis the first prototype is presented that has all Tribler functionality fully enabled on mobile devices.
The prototype is build for Android OS since Android dominates the smart-phone market.
% maybe geographical spread of Android?

The research question is: how feasible is it to run all Tribler functionality on mobile devices? % to defeat or mitigate large scale monitoring and censorship?
Secondary question is: using the unique properties of mobile devices, what features can be added or enhanced?
|BREAK|

First, what is required to run Tribler on Android?
Tribler is written in Python and uses various libraries written in C and C++.
To use these libraries on a mobile device they need to be compiled for the right embedded-application binary interface (EABI) including all nonstandard dependencies.
Since ARMv7 is currently supported by most Android phones it is the first to be supported by Tribler for now.


% https://kos.gd/posts/5-ways-to-use-python-with-native-code/
Calling C code directly from Python is possible by using the Python ctypes module to load a native dynamic-link library (.so files on Android) or by using the Python/C API of CPython.
This API enables a library to define functions that are written in C to be callable from Python.
These Python bindings are the glue between pure Python and pure C code.
SWIG can generate the boiler plate code for this.
Libtorrent, one of Triblers' main components, uses Boost.Python to provide a standard C++ API on top of the Python/C API.
Kivy uses Cython; P4A itself too??

The Python/C API is actually so powerful it even provides access to the internals of the interpreter to mess with the global interpreter lock (GIL) which could be released during native C calls to improve the multi-threading performance of Tribler crypto.

The Python-for-Android tool-chain provides a way (called recipes) to build these libraries and bindings with the necessary build tools.

P4A uses the Java native interface (JNI), between Java and C/C++ code, to launch the CPython interpreter from a thin Java Android application.
JNI enables to define functions that are written in C to be callable from Java.


Since API level 18 (Android 4.3 codenamed Jelly Bean MR2) loading native libraries dynamically from Python works properly (apparently).
API level 18 also added support for Bluetooth Low Energy (LE), WiFi scan only mode, key store for app-private keys, hardware credential storage and automated UI testing.
All very useful to Tribler.
Earlier versions of Android already supported NDEF Push with NFC and Wi-Fi P2P (since API level 14), and initiate large file transfers over Bluetooth via NFC (since API level 16).
83.7\% of devices on the Google Play Store run Android 4.3 or higher.


What alternatives are there, besides P4A, to run python code on Android?
1. QPython: scripting, cannot build regular .apk
2. PGS4A: no longer in development
3. SL4A: no longer in development
Why is P4A chosen?
Because this project continued from previous work (legacy code) build on P4A.
Even though the revamp version was build from scratch, it still is the best choice because it not only provides the Python interpreter, it also is a complete tool-chain to build a standalone .apk.

The Python-for-Android toolchain is used to cross compile the C/C++ libraries (and dependencies) with Python bindings for Android ARMv7.
On top of that the entire core of Tribler can run, containing a REST HTTP API module also written in Python.
The GUI is created by a native Android Java application, which talks to the REST API module.
This Java application contains an Android service that wraps the original P4A CPython launcher.
I changed this behavior to avoid having the GUI and back-end running in the same Python process, hindered by the GIL.
This approach is also superior to having two separate Python interpreters in distinct processes talking to each other, because that means using a very resource heavy Python GUI instead of the regular and lightweight native Android Java XML GUI.
The latter has tools available for automated UI testing.

% ... etc. (@see "my contributions" in thesis)

However this approach still suffers from performance issues due to imperfect multi-threaded coding of Tribler.
The Twisted module is used, which uses a single thread to coordinate all others, called the reactor thread.
If this thread is busy, the REST API can not even receive incoming requests resulting in timeouts.
Thanks to the separation of GUI and back-end this does not result in an unresponsive GUI, like older versions of Tribler are used to.


How well does it perform? (per feature / key performance indicator)
Compared to laptop?
Compared to centralized solution? (Youtube)




Via WiFi the device can connect to the Tribler network via existing infrastructure, but Android also supports peer-to-peer WiFi.
Using NFC Tribler can start a Bluetooth connection and transfer the installation package peer-to-peer.
Also via NFC Tribler can exchange channel ID's to subscribe to another Tribler channel peer-to-peer.
In the future the same method can be used to exchange bootstrap peers for the Tribler network.
The peer-to-peer Bluetooth file transfer could be made much faster if the WiFi Direct would be used.


Traditionally applications with a user interface execute tasks in the background while showing the progress to the user.
Due to the fact that Android targets mobile devices it is very optimized for low resource usage.
Therefore memory is freed more aggressively and the application is often paused or stopped and restarted if the user switches to another app.

To run in the background Tribler uses an Android service and all communication is performed asynchronously.
The reactive programming paradigm is a perfect fit for asynchronous tasks.
Thanks to RxJava and RxAndroid asychronous multi-threaded coding is made very enjoyable:
% code example
As shown in the code example performing IO tasks on the dedicated Android thread and making UI changes on the main thread becomes trivial.

The Retrofit library enables a very declarative API client.
% code example?


The latency of the API is shown in this figure:
% latency figure

The performance of Multichain:
% block creation graph
3 plots van onderling vergelijkbare resltaten
waarom moet dit experiment er zijn?
Om mobiele devices met Tribler volwaardige nodes in het netwerk te maken moeten ze multichain aankunnen ook na 10 jaar draaien.
Load test, simulatie 10 jaar. (174 days!)

feasibility of all Tribler functionality on mobile devices

what does mobile allow in addtion to desktop?





Future work:
comparative analysis
WiFi direct
cutting long running methods in smaller pieces, so multi-threading is smoother (only discovered now, earlier: why is gui hanging?)
release GIL in native C code, mainly for heavy crypto tasks
streaming API for big responses (dumping all known channels from db)



5 min. verhaal, rode lijn
welke keuzes
waarom keuzes zo

functionaliteiten vereist


wat heb ik gedaan, dan pas boek erbij


bijdrage: faciliterend voor future research, nuttig. Tribler features + phone benefits
aantonen? ja, nee, beide is resultaat
significance: demo paper, grand challenge

