\chapter{Implementation}


%%
Intro per chapter, refer to problem definition each time, where are we now, what now (for reader)
Why this chapter
Paragraphs
Conclusion of contents of this chapter
Link to next chapter




\section{Confront and tune} %choose alternative
%refer to KPI
%confront alternatives with objectives

What can go wrong?



Viral spreading
Multi user view
Autonomous region
Spreading app
Single leak to Internet
Solution to problem description


Show complete technology stack




Top/System level: common core, user friendly, not vulnerable to kill switches and censorship, ....


Functional level

Design level

Prototype level



Alternatives: choices, decision process
know what you don't know
Aware of what you did not do.


describe: chosen based on time investment, other 
P4A only app OR java + p4a app
imperative OR reactive



\subsection{Common Core}
10 years of Python code 
reusable multi-platform: Windows Mac Linux


Native Android app for Tribler with Java+xml GUI.
Using https://github.com/kivy/python-for-android to run Tribler python code as a native Android service.
The app communicates with the python service via the new rest api.

Picture of the technology stack and all components.


\section{Develop and organize} %implementation
%low prio


Verkopen: app build with reactive programming paradigm, Rx founded by TU Delft professor

code example
modular functional programming



\section{Tool-chain architecture}


we transfered the first generation bash script into a more involved python tool chain ecosystem
the p4a project accepted our first contribution the same day
our approach for this .. we focused on the low hanging fruit first to benefit from the learning effect
the first task consisted of porting the python bindings for 15 - 30+ commonly used libraries to Android [recipe example code block]

\subsection{Python-for-android}
Open source project p4a uses python toolchain with bootstraps, recipes, ant, make, Android SDK (aapt), Android NDK, zipalign, ..., setuptools, ...

\subsection{Gradle experimental}
Use Android SDK, jni, Android NDK, ...


\section{System architecture}
table of lines of code
modules app

\subsection{Python on Android}
Open source project Python-for-Android is capable of running python code.

no shell acces from Popen() means only single binaries instead of normal commands

\emph{My contributions:}
\begin{itemize}
	\item add service only bootstrap with templates
	\item recipe (missing) for all dependencies
	\item bug fixes in build tool chain
	\item service interface binder
\end{itemize}


\subsection{Rest API}

\emph{My contributions:}
\begin{itemize}
	\item create channel
	\item create torrent
	\item add torrent to channel
	\item async download and add torrent to channel from url and magnet links
	\item remote shutdown
\end{itemize}

\subsection{Common python core}

\emph{My contributions:}
\begin{itemize}
	\item correct paths for Android
	\item setup.py rewrite
	\item improve error handling in test runner
	\item various threading bug fixes
\end{itemize}


\subsection{Native Android GUI}
Gui for common core back-end and rest api in between.

\emph{My contributions:}
\begin{itemize}
	\item Native service wrapper for Python process
	\item GUI:
	\item create own channel
	\item record video
	\item create torrent file
	\item add torrent to own channel
	\item search torrents and channels
	\item voice search integration
	\item view channel contents
	\item download torrent
	\item launch video viewer
	\item mark and un-mark channel as favorite
\end{itemize}


